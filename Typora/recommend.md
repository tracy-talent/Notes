# recommend

## KNN_CF

* 程序说明
  1. local.scala，单机版本，指定测试样本条数(一个用户给一部电影的评分算一条样本)
  2. cf.scala，是local.scala的并行版本，同样是指定样本条数
  3. main.scala，并行版本，不同于cf.scala在于采用交叉验证，并且是指定用户为单元的样本而非单个评论为单元的样本。main主要是用来根据用户评分行为给出具体的推荐，并且可以根据每个项目在所有用户上的平均评分大小进行聚类。
  4. MAE.scala，并行版本，与main.scala基本一致，但是不同于main的是MAE.scala主要计算用户推荐的MAE(mean absulute error)，求用户最近邻时去除自身
  5. Utils.scala，工具类，比如统计数据集中用户数、项目数、建立项目id或者用户id的索引
* movielens_100k上跑出MAE=0.6926(邻居数设置300)

## Spark_ALS

* 程序说明
  1. LoadData.scala，数据预处理包，主要包括从原始数据文件中加载数据集并划分train:test=4:1，处理训练集生成按用户以及项目分组的评分(用于按单个用户、项目更新隐特征向量)、随机初始化生成所有用户和项目的隐特征向量、评估指标RMSE计算
  2. als.scala，负责交替最小二乘als(alternative least square)算法的训练过程，交替求解用户、项目特征向量的梯度并进行更新。
* evaluation: ml-10m上RMSE=0.8007($\lambda=0.08$，隐特征向量长度10: <font style='background:yellow'>不宜设置过长，因为评分只有1\~5，初始化0\~1的隐特征向量$V^TV$足以表示这个评分范围</font>，loss阈值0.0001)

<font color='red'>问题：</font>

1.为什么不直接使用LS而要使用ALS优化？

答: 因为两个隐变量耦合在一起，不像LS待求解参数相互独立(即其他参数不影响该参数对模型最优解的影响)，因此LS求每个参数偏导=0方程联立求解出来的参数解即为最优。而参数互相耦合下，一个参数的模型最优解受其耦合参数的影响，而一次只能对其中一个参数求偏导=0，因此使用交替求解耦合参数偏导=0的方法使得模型逐步收敛。